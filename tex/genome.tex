%\documentclass[conference,compsoc]{IEEEtran}
\documentclass{article}
\usepackage{url,epsfig,ifthen}
\title{What does it mean to own our genes?\\
{\small Genetic De-anonymization Attacks and Implications for Privacy}}
%Draft}}
\author{Arvind Narayanan \\
{\small Stanford University}}

\newcommand{\XX}{{\cal X}}
\newcommand{\YY}{{\cal Y}}
\newcommand{\Adv}{\textsf{Adv}}
\newcommand{\PP}{\textsf {PP}}
\newcommand{\PR}{\textsf {PR}}
\newcommand{\bkg}{\textsf {BkGnd}}
\newcommand{\priv}{\textsf {priv}}
\newcommand{\pub}{\textsf {pub}}
\newcommand{\Aux}{\textsf {Aux}}
\newtheorem{definition}{Definition}

\newcommand{\grumbler}[2]{\begin{quote}\sl{\bf #1:} #2\end{quote}}
\newcommand{\arvind}[1]{\grumbler{Arvind}{#1}}

\newcommand{\ie}{\textit{i.e.}}
\newcommand{\eg}{\textit{e.g.}}

\begin{document}
\maketitle




\begin{abstract}
The right of a person to control his or her own data is a fundamental tenet of privacy advocacy today. This position implicitly assumes the {\em possibility} of such control, at least with the co-operation of the powers that be -- broadly, the government, and those involved in data collection and analysis.

In the context of genetic data, it is well known that each person shares genetic material with blood relatives, and that the extent of sharing is dependent upon the degree of the relationship. Given this fact, how does the notion of an ``owner'' of each piece of data hold up? Does it merely need to be modified, or jettisoned entirely, thus necessitating an overhaul of the genetic privacy debate?

We show that the answer is likely to be disturbingly close to the latter possibility. The key to our conclusion is an analysis of what an adversary, equipped with realistic ``auxiliary information,'' might be able to deduce from completely anonymous genetic material -- for instance, pieces of hair collected {\em en masse} from public spaces without the consent, or even the {\em knowledge}, of the potential victims. We qualify and quantify the conditions under which identities can be affixed to these surreptitiously collected samples, and argue that these conditions will become a reality within a few short years.

There does not appear to be a purely technological fix to our attack. We briefly present policy prescriptions that may delay the eventuality of genetic re-identifiability, and argue that genetic privacy norms must change to accomodate the new technological reality.
\end{abstract}

\section{Introduction}

Threats to genetic privacy have been of great concern to society every since the dawn of DNA fingerprinting. However, the availability of cheap genotyping in the last few years has changed the scale of the threat so much as to make it qualitatively different. For instance, at the time of this writing, a ``personal genomics'' kit costs \$399 \cite{23-and-me} and has been estimated to capture over 50\% of the entropy in the human genome \cite{snpentropy}.

Privacy violations could take many forms, such as data breaches and non-consensual information sharing. Protection against such violations falls under the domain of public policy, law enforcement and computer security. We are instead concerned about {\em inference attacks}, which result in unexpected revelation of sensitive facts about individuals from data or samples that might at first glance appear to hide the facts in question.

Inference attacks have recently received considerable attention: in 2007, Homer {\em et al} showed how to determine  if an individual contributed DNA to a mixture, by analyzing only the {\em aggregate} values of each genotype locus. Further papers have discussed this attack, arguing that it is either less serious \cite{sriram} or more serious \cite{css} than previously thought.  In other work, Goodrich analyzed threats to the privacy of mitochondrial DNA sequences \cite{goodrich}.

Common to these attacks is the fact that the victim needs to have first voluntarily provided an identifiable DNA sample or their genotype information. On the other hand, we consider the question of what an adversary can learn from a completely anonymous genetic sample -- for instance, pieces of hair collected {\em en masse} from public spaces without the consent, or even the {\em knowledge}, of the potential victims.

 Our analysis rests on the assumption that two types of data will become available to powerful adversaries within at most a decade or two: 
\begin{itemize}
\item
a {\em genealogical graph} representing of a significant fraction of all blood relationships among a large population group
\item
{\em genotypes} of a small fraction of the individuals represented in the above graph
\end{itemize}

Fast algorithms to identify shared (``identical-by-descent'') genetic sequences between related individuals have recently been developed \ref{germline}. This enables the adversary, with some confidence, to (probabilistically) detect even remote blood relationships among individuals.

Our main technical contribution is an inference attack which searches for familial relationships between the genotype of an unknown individual and each of a set of identified genotypes, and uses the relationships thus obtained to identify the node in the graph corresponding to the unknown genotype. The algorithm has these properties:
\begin{itemize}
\item
requires only a small fraction of labeled nodes
\item
can tolerate noise
\item
can tolerate missing data
\item
works on a variety of mating models
\item
If the unknown genotype does not correspond to any node in the graph, the  algorithm is able to detect this.
\end{itemize}

Let us walk through a simple example to illustrate how such re-identification could be carried out. Let us call our victim Victor, the individual whose genetic information the adversary possesses.  Victor's node happens to be somewhere in the genealogical graph available to the adversary; the adversary would like to find out if that is in fact the case, and if so, determine the identity of the node. Suppose that two of the victim, Victor's cousins Peggy and Sue have labeled genotypes available in the graph. Furthermore, assume that Victor is related to Peggy through his mother and to Sue through his father.  

[illustration here]

Given this setup, the adversary can now determine that unlabeled genotype comes from someone who shares 1/8 of their DNA with both Peggy and Sue.\footnote{The attacker can deduce more than this: for instance, analyzing the {\em number} of shared segments in addition to their {\em total length} can tell him that the related individuals share a pair of grandparents, rather than one being a great-grandparent of the other, which would also result in a $\frac{1}{8}$ shared genome. However, we ignore this for the purpose of this  example.} Intuitively, if all mating pairs in the family tree are a) monogamous and b) have no recent common ancestor, then the only nodes that satisfy the constraints available to the adversary are Victor, and any siblings he might have. The adversary looks at the graph and determines that the sample came either from Victor, his sister Wanda, or any other siblings he might have who are not represented in the graph.

Since it is impossible to distinguish between siblings without further auxiliary information, we consider the adversary to be successful in this case. In Section \ref{}, we outline how to carry out further de-anonymization using other auxiliary information. Thus, even if Victor has not been completely de-anonymized, it can serve as useful starting point for manual analysis which can complete the de-anonymization. Therefore, our algorithm outputs a sequence of ``sibling groups'' in decreasing order of match probability.

Unlike our toy example above, in reality there are several factors that make the inference far more complex: 

\begin{itemize}
\item
Due to the small fraction of labeled genotypes available to the attacker, the probability that a random node in the graph has a labeled cousin is very small. In fact, our algorithm is successful with so few labeled genotypes that an average node has no fourth cousin or closer that is labeled.
\item
We do not make any assumptions about monogamy or common ancestry among mating pairs. (In Section \ref{}, we provide a detailed analysis for a range of different mating models.)
\item
The graph could be incomplete or have errors. Because of this, you never know the exact relationship, but only approximations.
\end{itemize}

The rest of the paper is organized as follows: in Section \ref{reidentification}, we present a survey of re-identification techniques in computer science and their implications for data privacy. ...




%\section{Data collection survey}



\section{Genealogical Databases: A Survey}
Recall that there are two types of data that are crucial to the success of our attack: genealogical data and  genotypes of known individuals. This section is dedicated to the former; we survey a) the types of original data sources that can be used to compile genealogical graphs\footnote{it must be borne in mind that reconstructing genealogy is much more feasible when multiple sources are combined} and b) the existing organizations and databases of genealogical information. 
In the interest of brevity, we focus on the U.S. and the U.K.; information about other countries is summarized in Appendix \ref{}.

First, let us consider the process of constructing a genealogical graph from one or more databases of individual records, which have no links either between records or between the different databases.  There are three main algorithms that are needed:

{\bf Entity resolution}, also known as identity resolution, and in the genealogy context as record matching or record linking. It involves resolving records across different databases as the same entity, based on a fuzzy matching of attributes; a simple example would be matching names via Soundex. Record linkage is an extremely well-studied problem and as one might imagine, has applications everywhere. W.E. Winkler of the U.S. Census Bureau has authored two surveys \cite{winkler-survey-99,winkler-survey-06} from the statistics perspective.

{\bf Lineage linking} is a specific type of record linking, involving inferring (kin) relationships between individuals. For example, using the parents' names reported in a birth record to link an individual to the resolved entities corresponding to the parents constitutes lineage linking. A lineage-linked database of individuals is essentially a genealogical graph, albeit possibly containing errors and inconstencies.

GEDCOM is a widely used standard for lineage-linked data developed by the LDS Church; an example GEDCOM record is presented in Appendix \ref{}.

{\bf Graph merging} operates at a more global level, and tries to merge two genealogical graphs \cite{wilson-merge}. As opposed to record linkage, graph merging algorithms are still in their infancy, and little information exists in the published literature. Agarwala {\em et al.}\cite{anabaptist} describe merging two genealogies of the North American Anabaptist population consisting of around 56,000 and 31,000 individuals respectively. Interestingly, new relationships are created in the merged graph which exist in neither original graph. 

%Merging is employed by the LDS in creating the ancestry file.  

{\bf Living vs. deceased persons.} Recall that although the privacy harms of our attack (or any other attack) impact mostly the living, our modus operandi is to find remote familial relationships between individuals via distant common ancestors (5-7 generations). This means that it is important for the attacker to have auxiliary information in the form of genealogical data extending back well into the nineteenth century.

Obtaining data on deceased persons turns out to be significantly different from living people. There are two key differences: many sources of genealogical data apply (some) privacy controls for living persons, and usually none for deceased persons. Second, data on deceased pesons has often been irretrievably lost, especially the farther one goes back in time, whereas for living persons the information at least in human memory, even if it may not be easy for the attacker to obtain.

%In the light of the different level of availability for records pertaining to living and dead people, not only from official bureaus but also from private organizations such as the LDS church (see below), we divide our survey into these two categories.

Let us now turn to data sources. Broadly, these can be divided into official sources and user-contributed data. Official sources further subdivide into vital records, census records, and other miscellaneous public sources such as voter registration lists and property records.

\subsection{Vital records}

Birth, death, marriage  and divorce records are collectively known as ``vital records.'' In the United States, vital records are typically maintained at the state level. These records are for the most part public, although not always available {\em en masse} in digital form. A summary of availability can be found in \cite{messing}. Some salient points to note are:
\begin{itemize}
\item
Birth records are ``aged'' by between 50 to 75 years, i.e., some information is redacted in records that are less than that age.
\item
Each county maintains records in microfiche form, but most of the larger states aggregate this information in digital form at the state level. 
\item
The authors note that ``as time progresses, public information stored at even the smallest county offices will invariably become digitally available."
\end{itemize}

In the United States, there is a drop-off in the availability of vital records before the 1900s. The situation in European countries is much better: In the United Kingdom, for instance, vital records have been collected since at least 1837 \cite{ukbmd.org.uk} and contains an estimated 170 million unique records. Data from prior dates is often available from parish registers from individual counties. \footnote{Need survey of more European countries.} 

Vital records may be made available by official bureaus either in original paper form, or in microform, or electronically. The process of converting from paper to an indexed electronic database involves two steps:

{\bf Digitization} First, the paper records are converted into microfilm or microfiche. These are document storage formats that physically compress the size by a factor of 25 or more \cite{wp-microform}. The microform documents are then converted to digital images using a microfilm/microfiche reader. 

{\bf Transcription} Next, the resulting images are converted into text. Many organizations involved in making vital records available online achieve this time-consuming step by ``crowdsourcing'' it to volunteers participating over the Internet.

Constructing a genealogy from vital records is not trivial, but can in large part be automated: 
\begin{itemize}
\item
The information available -- first and last name, place (to the resolution of a county), and age -- is usually sufficient to carry out record linking, even in the absence of unique identifiers.
\item
For unredacted or ``aged'' records, the parents' names are available. Combined with other attributes, this makes lineage linking possible.
\item
Even when the parents' names have been redacted, \cite{messing} provide a variety of heuristics that they use to infer the mother's maiden name, many of these heuristics can also be used for lineage linking.
\end{itemize}

\subsection{Census records}

Census records are an invaluable source of genealogical research. In the United States, they are maintained by the National Archives. The first Federal Population Census was taken in 1790, and has been taken every ten years since. Due to privacy reasons, data is available only for the 1930 and earlier censuses. The National Archives makes census records available on microfilm from 1790 to 1930. These have been completely transcribed by private companies (see survey below.)

The following information is available for each individual covered by the 1850-1930 censuses: name, age, state or country of birth, parents' birthplaces, year of immigration, street address, marriage status, years of marriage, occupation, and a few other attributes. The situation in the UK is similar in terms of information available; micro-data from the 1851-1901 censuses are currently public.

Record linkage across censuses is possible, and there are a number of efforts to unify the micro-data across the historical censuses; for instance, see \cite{ipums-usa}. Lineage linking is possible to an extent because the members of a household are listed together; however, census records alone provide no definite link between a woman's maiden and married names. We are not aware of any efforts to derive lineages from census records, but they may serve as an excellent complement to vital records.


\subsection{Other official public records}

The National Archives website claims that federal records are a ``treasure chest of genealogical information''\cite{nara-faq}. Military, immigration, naturalization and land records are some other types of official records that are useful as genealogical sources. 
More information can be found in \cite{nara-faq}. 

Land and property records from earlier periods can be particularly useful because deeds contain very detailed information in an effort to identify the individual as completely as possible. Modern property records can be useful for tracking people who move to a different state \cite{messing}.

Voter registration records in the United States have been public since 1995 by the National Voter Act of 1993. These are particularly useful for genealogical reconstruction because they list the maiden name. 

The Social Security Death Index -- which was created as a way to prevent identity theft of the recently deceased -- has been used in enabling privacy breach, most famously in \cite{acquisti-ssn}. According to Griffith and Jakobsson, the SSDI improves the ability to link death and marriage records \cite{messing}.

\subsection{Secondary sources of official records}

As noted, official records are often made available only in microfilm, and may not be available from a central source. Even after digitization, there remains the task of constructing a lineage-linked database, and of aggregating different databases. The availability of such cleansed and aggregated data makes a huge difference to the practical feasibility of our attack. Considering that the source data is public, it is quite likely that the processed data will eventually become publicly available. Nevertheless, it is important to survey the current availability of official records from secondary sources.

{\bf Ancestry.com}, Inc., based on Provo, Utah, is the largest for-profit genealogy company in the world \cite{wp-ancestry.com}. It operates a variety of websites including ancestry.com, genealogy.com, myfamily.com and rootsweb.com. They have completed the indexing of all U.S. Census lists for which micro-data is available. 

{\bf FreeBMD} is a UK-based charitable organization that has the goal of creating a free transcription of vital records (called ``BMD," for ``Births, Marriages and Deaths'' in the UK context), and making them freely available on the Internet.  Currently, over 170 million unique records have been transcribed.

{\bf FamilySearch} is a project of the U.S.-based {\bf Church of the  Latter Day Saints.} The LDS church maintains the International Genealogical Index, which has data on 250 million names \cite{familysearch}. There are currently 200 cameras converting vital records into microfilm, and the transcription process is crowdsourced. 

\subsection{Genealogy 2.0} A rapidly growing source of user-contributed genealogical data comes from the trend of ``genealogy 2.0'' websites that combine collaborative genealogy with family-based social networking. Most of these sites have the explicit goal of colleting a genealogical graph of the entire human population. The typical process is for members to create an account, which is associated with their node in the genealogical graph, and then extend their family tree starting from that node.

Graph merging is  an essential feature of all major websites in this category including Geni\cite{geni-merge}, onegreatfamily.com\cite{onegreatfamily-merge} and MyHeritage\cite{myheritage-merge}.  It is essential in order to unify the family trees contributed by different individuals.  Merges with high similarity scores happen automatically but others require human intervention.

Another approach to genealogy 2.0 is to integrate family-features with a general-purpose social network. The leaders in this space appear to be two Facebook applications ``We're Related'' \cite{fb-wererelated} and ``Family Tree'' \cite{fb-familytree}, with 20 million and 5 million active users respectively as of September 2009. Family Tree is also available on other social networks, and claims 12 million users and 55 million profiles overall. 
The company, Familybuilder Inc., also offers genetic genealogy services.

None of these sites have nearly as much data or traffic as ancestry.com. However, ancestry.com has failed to add social features, and therefore these newer competitors currently have more momentum and growth.

% linking, record matching, entity resolution, identity resolution, name matching, automated genealogy

\section{Background on re-identification}
The study of data re-identification is a subfield of information science that has mushroomed in the last decade. In 1998, Sweeney \cite{sweeney} showed that Massachusetts hospital records blah blah. 

 Sweeney, Malin and Sweeney, AOL, Netflix, Social networks, Golle, Ohm, case law.

\section{Genetics background and model}
The human genome consists of 23 pairs of chromosomes. 

Autosomes/sex chromosomes

{\bf Meiosis.}

\subsection{Germline}

\section{Attack}

\section{Results}

\section{Discussion}
The genetic information in a person's cells was not created by him or her, nor by any other individual. In this important respect, genetic information differs from most other types of information of commercial value that people ``own,'' such as the books they write or even their shopping history. Our genetic information has evolved since the dawn of our species, and indeed since the dawn of life on earth. Needless to say, the notion of ownership of genetic data has been fraught with philosophical difficulties.

One issue that courts have wrestled with is the right to patent a beneficial allele or cell line. Different U.S. states have different rules, some giving the right to the individual, and others demurring \cite{john-moore-who-owns-your-genetic-information}.

A related issue is  privacy: to what extent does an individual have the right to force a health provider to keep a piece of genetic information (such as a hereditary) secret, given that 1) his blood relatives may well share the same genes 2) it might be in the interest of his relatives to have this information revealed to them, perhaps a matter of life and death?


\section{Glossary of terms}
\bibliographystyle{plain}
\bibliography{all}


\end{document}
